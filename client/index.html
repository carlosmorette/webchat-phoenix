<!DOCTYPE html>
<html lang="pt-br">
     	<head>
		<meta charset="UTF-8"/>
		<title>WebSocket</title>
	</head>
	<body>
		<p>Say hello!</p>
		<input placeholder="Name to add..." />
		<button>Enviar</button>
	</body>
	<script src="scripts.js"></script>
	<script>
		const ws = new WebSocket("ws://localhost:4000/socket/websocket")

	//	wsControll = ChatControll(ws, "chat:lobby")	
	//	wsControll.connect("chat:lobby")
	//	wsControll.sendMessage({
	//			topic: "chat:lobby",
	//			event: "new_message",
	//			payload: "Oi brooo",
	//			ref: "umareferenciaqualquer"
	//	})

		ws.onopen = () => {
			console.log("Conexão abriu")
			const message = {
				topic: "chat:lobby",
				event: "phx_join",
				payload: "this is payload man",
				ref: "join",
			}
			ws.send(JSON.stringify(message))

			ws.send(JSON.stringify({
				topic: "room:lobby", 
				event: "new_message", 
				payload: "Olá, tudo bem",
				ref: "message"
			}))
		}

			ws.addEventListener("message", ({ data }) => {
				console.log(JSON.parse(data))
			})
	</script>
<html>
